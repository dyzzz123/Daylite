# 浏览器验证模式使用指南

## 功能说明

Daylite 现在支持两种RSS源验证模式，以解决某些RSS源无法通过服务端验证的问题。

### 问题背景

某些RSS源（如V2EX、RSSHub等）会拒绝来自服务器的请求，但允许浏览器访问。这是因为：

1. **反爬虫机制** - 检测并拒绝服务器端的User-Agent
2. **访问限制** - 限制服务器IP的访问频率
3. **CORS策略** - 对不��客户端有不同的访问策略

### 解决方案：浏览器验证模式

现在你可以使用**浏览器验证模式**，让浏览器直接获取RSS源，绕过服务端限制。

## 两种验证模式对比

| 特性 | 服务端验证（默认） | 浏览器验证（新模式） |
|------|------------------|-------------------|
| **原理** | 服务器直接访问RSS源 | 浏览器访问RSS源 |
| **适用场景** | 大多数公开RSS源 | V2EX、RSSHub等受限源 |
| **速度** | 快速（服务器带宽） | 较慢（受限于用户网络） |
| **成功率** | 标准RSS源100% | 可访问受限源 |
| **CORS限制** | 无 | 部分源可能有CORS限制 |

## 如何使用

### 步骤1：打开添加RSS对话框

1. 点击右上角 ⚙️ 设置按钮
2. 点击 "自定义 RSS" 卡片

### 步骤2：启用浏览器验证模式

在RSS链接输入框下方，你会看到一个开关：

```
🌐 浏览器验证模式
   绕过服务端限制，验证V2EX等源
   [开关] ○ ---- ●
```

点击开关启用浏览器验证模式。

### 步骤3：验证RSS源

输入RSS链接（例如：`https://www.v2ex.com/index.xml`），点击"验证"按钮。

**成功提示：**
```
✓ RSS源验证成功（浏览器）！
```

系统会自动填充RSS源名称。

### 步骤4：完成添加

选择图标，点击"添加订阅"即可。

## 测试结��

### ✅ 可以验证的RSS源（浏览器模式）

| RSS源 | URL | 状态 |
|-------|-----|------|
| V2EX | https://www.v2ex.com/index.xml | ✅ 可验证 |
| RSSHub南方周末 | https://rsshub.app/infzm/2 | ✅ 可验证 |
| RSSHub煎蛋 | https://rsshub.app/jandan/top | ✅ 可验证 |

### ⚠️ 注意事项

**CORS限制：**
某些RSS源可能仍然无法通过浏览器访问，因为存在CORS（跨域资源共享）限制。

**解决方案：**
1. 尝试使用RSS源的镜像
2. 使用RSS2JSON等转换服务
3. 联系RSS源管理员

## 常见问题

### Q1: 为什么浏览器模式还是失败？

A: 可能存在CORS限制。尝试：
- 使用HTTPS而不是HTTP
- 尝试RSS源的镜像站点
- 查看浏览器控制台的具体错误信息

### Q2: 浏览器模式和服务端模式有什么区别？

A:
- **服务端模式**：服务器访问RSS源，更快但某些源受限
- **浏览器模式**：你的浏览器访问RSS源，可以绕过某些限制

### Q3: 应该使用哪种模式？

A:
- **大多数RSS源**：使用默认的服务端模式
- **V2EX、RSSHub等**：使用浏览器模式
- **验证失败时**：尝试切换模式

### Q4: 浏览器模式会影响性能吗？

A: 不会。浏览器模式只在验证时使用，添加RSS源后的内容抓取仍然在服务端进行。

### Q5: 为什么RSS源验证成功，但抓取时超时？

A: 这是两个不同的过程：
- **验证**：检查RSS源是否可用
- **抓取**：服务器定期获取RSS内容

如果浏览器验证成功但服务端抓取超时，说明该源限制了服务端访问。这是正常现象，建议使用其他RSS源。

## 技术实现

### 客户端RSS获取器

浏览器模式使用纯JavaScript实现，无需服务端代理：

```typescript
// 直接在浏览器中获取RSS
const response = await fetch(url, {
  headers: {
    'Accept': 'application/rss+xml, application/xml, text/xml, */*',
    'User-Agent': navigator.userAgent,
  },
});

// 使用DOMParser解析XML
const parser = new DOMParser();
const xmlDoc = parser.parseFromString(xmlText, 'text/xml');
```

### 支持的RSS格式

浏览器模式支持以下格式：
- RSS 2.0
- Atom 1.0
- RDF 1.0

## 示例RSS源

### 推荐使用浏览器模式验证

1. **V2EX**
   ```
   https://www.v2ex.com/index.xml
   ```

2. **RSSHub源**
   ```
   https://rsshub.app/infzm/2  # 南方周末
   https://rsshub.app/jandan/top  # 煎蛋
   https://rsshub.app/npc/news/latest  # 人民网
   ```

### 推荐使用服务端模式验证

1. **36氪**
   ```
   https://36kr.com/feed
   ```

2. **少数派**
   ```
   https://sspai.com/feed
   ```

3. **IT之家**
   ```
   https://www.ithome.com/rss/
   ```

## 总结

浏览器验证模式是解决服务端访问限制的有效方案。如果遇到RSS源验证失败，记得尝试切换到浏览器模式！

**提示**：建议先尝试默认的服务端模式，失败后再切换到浏览器模式。
